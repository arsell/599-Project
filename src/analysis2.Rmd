---
title: "Final Report"
author: 
- "Todd Albertson"
- "Jenny Fingles"
- "Max McDonald"
- "Austin Sell"
date: "`r format(Sys.time(), '%B %d, %Y')`"
# abstract: "Abstract..."
output:
    pdf_document:
      fig_caption: yes
fontsize: 12pt
geometry: margin=1in
header-includes:
    - \usepackage{setspace}
    - \doublespacing
---

---
references:
- id: FakeyShenanigans2019
  title: "An example citation: Examples from an article of examples"
  author:
  - family: McFakerson
    given: Fakey F.
  - family: Shenanigans
    given: Bull
  container-title: QJBS
  volume: 1
  issue: 1
  page: 50-90
  type: article-journal
  issued:
    year: 2019
---

\pagebreak

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
```

```{r}
#loading necessary packages

library(lme4)
library(ggplot2)

options(scipen = 999)
options(digits = 6)
```


```{r}
data <- read.csv("https://github.com/arsell/599-Project/blob/master/data/cleandata.csv?raw=true")
data <- na.omit(data)
```

```{r}
# Investigate age vs educ relationship
p1 <- ggplot(data = data,
             aes(x = age,
                 y = educ)) +
  geom_point(position = "jitter") +
  stat_smooth(geom = "smooth")

p1
```

```{r echo=TRUE}
data$religion <- relevel(data$religion, ref="Other")

fit1 <- lm(educ ~ religion + age + region + wealthCat + urban, data=data)
summary(fit1)



fit2 <- lmer(educ ~ religion + age + wealthCat + urban + (1|region),
             data = data,
             REML = FALSE)
summary(fit2)

data$age2 <- data$age^2

fit3 <- lm(educ ~ religion + age + age2 + region + wealthCat + urban, data=data)
summary(fit3)

fit4 <- lmer(educ ~ religion + age + age2 + wealthCat + urban + (1|region),
             data = data,
             REML = FALSE)
summary(fit4)

fit5 <- lm(educ ~ religion + age + wealthCat*region + urban, data = data)
summary(fit5)

fit6 <- lmer(educ ~ (1|region),
             data = data,
             REML = FALSE)
summary(fit6)

fit7 <- lmer(educ ~ religion + age + urban + (1 + wealthCat|region),
             data = data,
             REML = FALSE)
summary(fit7)

fit8 <- lmer(educ ~ religion + age + urban + wealthCat + (1 + wealthCat|region),
             data = data,
             REML = FALSE)
summary(fit8)
```

```{r}
fit <- list(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8)


bic.list <- NULL
for (i in 1:length(fit)){
  bic.list <- BIC(fit[[i]])
}

source("functions.R")

mae1 <- get_mae(fit1, data, method="lm")
mae2 <- get_mae(fit2, data, method="lmer")
mae3 <- get_mae(fit3, data, method="lm")
mae4 <- get_mae(fit4, data, method="lmer")
mae5 <- get_mae(fit5, data, method="lm")
mae6 <- get_mae(fit6, data, method="lmer")
mae7 <- get_mae(fit7, data, method="lmer")
mae8 <- get_mae(fit8, data, method="lmer")
```

# Introduction and Motivation

Here we can introduce our central research question. I don't believe citations are crucial to this project, but we can include them if necessary [@FakeyShenanigans2019].

# Data

Here is where we explain where the data comes from. Any descriptive statistics would be included here.

# Analysis

In this section we explain how our model is set up and any necessary assumptions. Model selection criteria should be included here as well.


| Model | BIC           | MAE      |
|:-----:|:-------------:|:--------:|
| 1     | `r BIC(fit1)` | `r mae1` |
| 2     | `r BIC(fit2)` | `r mae2` |
| 3     | `r BIC(fit3)` | `r mae3` |
| 4     | `r BIC(fit4)` | `r mae4` |
| 5     | `r BIC(fit5)` | `r mae5` |
| 6     | `r BIC(fit6)` | `r mae6` |
| 7     | `r BIC(fit7)` | `r mae7` |
| 8     | `r BIC(fit8)` | `r mae8` |

# Results

We present the results of the model, including tables and/or figures. This should have the direct numerical interpretation of the key coefficients.

# Conclusion

Discussion of the substantive interpretation of the model, including any meaningful impact of findings as well as limitations of model.

\pagebreak

# References


